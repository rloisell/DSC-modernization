<mxfile host="app.diagrams.net" modified="2026-02-20T00:00:00.000Z" agent="GitHub Copilot" version="24.5.2">
  <diagram id="seq-admin-crud" name="Admin Project Assignments CRUD — Sequence">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1700" pageHeight="1500" math="0" shadow="0" background="#ffffff">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        
        <mxCell id="title" value="Admin Project Assignments CRUD — Sequence Diagram" style="text;html=1;fontStyle=1;fontSize=14;strokeColor=none;fillColor=none;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="10" width="1400" height="30" as="geometry" />
        </mxCell>

        
        <mxCell id="p_admin" value="Admin" style="shape=mxgraph.sequence.actor;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;" vertex="1" parent="1"><mxGeometry x="50" y="50" width="80" height="80" as="geometry" /></mxCell>
        <mxCell id="p_ui" value="Admin&#10;Assignments&#10;(Browser)" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="185" y="90" width="110" height="30" as="geometry" /></mxCell>
        <mxCell id="p_auth" value="AdminToken&#10;AuthHandler" style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="360" y="90" width="100" height="30" as="geometry" /></mxCell>
        <mxCell id="p_ctrl" value="AdminProject&#10;Assignments&#10;Controller" style="rounded=1;fillColor=#ffe6cc;strokeColor=#d6b656;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="520" y="90" width="110" height="30" as="geometry" /></mxCell>
        <mxCell id="p_dbctx" value="Db&#10;Context" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="700" y="90" width="100" height="30" as="geometry" /></mxCell>
        <mxCell id="p_geh" value="Global&#10;Exception&#10;Handler" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="870" y="90" width="100" height="30" as="geometry" /></mxCell>
        <mxCell id="p_db" value="MariaDB" style="shape=mxgraph.flowchart.database;fillColor=#f5f5f5;strokeColor=#666;fontStyle=1;fontSize=9;" vertex="1" parent="1"><mxGeometry x="1030" y="80" width="80" height="50" as="geometry" /></mxCell>

        
        <mxCell id="ll_admin" style="endArrow=none;dashed=1;strokeColor=#6c8ebf;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="130" /><mxPoint x="90" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_ui" style="endArrow=none;dashed=1;strokeColor=#6c8ebf;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="120" /><mxPoint x="240" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_auth" style="endArrow=none;dashed=1;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="410" y="120" /><mxPoint x="410" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_ctrl" style="endArrow=none;dashed=1;strokeColor=#d6b656;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="120" /><mxPoint x="575" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_dbctx" style="endArrow=none;dashed=1;strokeColor=#d6b656;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="750" y="120" /><mxPoint x="750" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_geh" style="endArrow=none;dashed=1;strokeColor=#b85450;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="920" y="120" /><mxPoint x="920" y="1450" /></Array></mxGeometry></mxCell>
        <mxCell id="ll_db" style="endArrow=none;dashed=1;strokeColor=#666;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="1070" y="130" /><mxPoint x="1070" y="1450" /></Array></mxGeometry></mxCell>

        
        <mxCell id="sec1" value="Page Load — Read All Assignments" style="swimlane;startSize=18;fillColor=#f0f0f0;strokeColor=#666;fontStyle=2;fontSize=9;" vertex="1" parent="1"><mxGeometry x="60" y="145" width="1200" height="20" as="geometry" /></mxCell>

        <mxCell id="m1" value="1. Navigate to /admin/project-assignments" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="185" /><mxPoint x="240" y="185" /></Array></mxGeometry></mxCell>
        <mxCell id="m2" value="2. GET /api/admin/project-assignments  (X-Admin-Token)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="215" /><mxPoint x="575" y="215" /></Array></mxGeometry></mxCell>
        <mxCell id="m3" value="3. ProjectAssignments.Include(Project).Include(User).ThenInclude(Position)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="250" /><mxPoint x="750" y="250" /></Array></mxGeometry></mxCell>
        <mxCell id="m4" value="4. SELECT pa.*, p.*, u.*, pos.* FROM ProjectAssignments pa JOIN … LEFT JOIN Positions" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="750" y="275" /><mxPoint x="1070" y="275" /></Array></mxGeometry></mxCell>
        <mxCell id="m4r" value="rows (with UserPosition = pos.title)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;dashed=1;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="1070" y="300" /><mxPoint x="240" y="300" /></Array></mxGeometry></mxCell>

        
        <mxCell id="filternote" value="5. Populate filter dropdowns (client-side, useMemo):&#10;   Project | User | Position&#10;   (All derived from assignments already loaded — no extra API calls)" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;align=left;" vertex="1" parent="1"><mxGeometry x="200" y="315" width="360" height="50" as="geometry" /></mxCell>

        
        <mxCell id="sec2" value="Client-Side Filtering (no API call)" style="swimlane;startSize=18;fillColor=#f0f0f0;strokeColor=#666;fontStyle=2;fontSize=9;" vertex="1" parent="1"><mxGeometry x="60" y="380" width="1200" height="20" as="geometry" /></mxCell>
        <mxCell id="m5" value="6. Select Project / User / Position filter" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="415" /><mxPoint x="240" y="415" /></Array></mxGeometry></mxCell>
        <mxCell id="cfnote" value="combinedFilter (useMemo):&#10;filter by projectId AND userId AND position&#10;Re-renders table instantly — no round-trip" style="shape=callout;whiteSpace=wrap;fontSize=9;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;" vertex="1" parent="1"><mxGeometry x="200" y="425" width="290" height="55" as="geometry" /></mxCell>

        
        <mxCell id="sec3" value="Create — Assign User to Project" style="swimlane;startSize=18;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=2;fontSize=9;" vertex="1" parent="1"><mxGeometry x="60" y="500" width="1200" height="20" as="geometry" /></mxCell>
        <mxCell id="m6" value="7. Click 'Add Assignment' → fill form (project, user, role, estimatedHours)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="538" /><mxPoint x="240" y="538" /></Array></mxGeometry></mxCell>
        <mxCell id="m7" value="8. POST /api/admin/project-assignments  Body: {projectId, userId, role, estimatedHours}" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="568" /><mxPoint x="575" y="568" /></Array></mxGeometry></mxCell>
        <mxCell id="m8" value="9. Check duplicate: FindAsync(projectId, userId)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="598" /><mxPoint x="1070" y="598" /></Array></mxGeometry></mxCell>
        <mxCell id="m8r" value="null (new)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;dashed=1;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="1070" y="618" /><mxPoint x="575" y="618" /></Array></mxGeometry></mxCell>
        <mxCell id="m9" value="10. INSERT INTO ProjectAssignments (projectId, userId, role, estimatedHours)" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="648" /><mxPoint x="1070" y="648" /></Array></mxGeometry></mxCell>
        <mxCell id="m9r" value="201 Created — ProjectAssignmentDto" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;dashed=1;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="678" /><mxPoint x="240" y="678" /></Array></mxGeometry></mxCell>
        <mxCell id="dup" value="alt [duplicate] → 409 Conflict ProblemDetails 'Assignment already exists'" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1"><mxGeometry x="540" y="695" width="400" height="25" as="geometry" /></mxCell>

        
        <mxCell id="sec4" value="Edit Assignment" style="swimlane;startSize=18;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=2;fontSize=9;" vertex="1" parent="1"><mxGeometry x="60" y="740" width="1200" height="20" as="geometry" /></mxCell>
        <mxCell id="m10" value="11. Click Edit → update role / estimatedHours" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="778" /><mxPoint x="240" y="778" /></Array></mxGeometry></mxCell>
        <mxCell id="m11" value="12. PUT /api/admin/project-assignments/{projectId}/{userId}  Body: {role, estimatedHours}" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="808" /><mxPoint x="575" y="808" /></Array></mxGeometry></mxCell>
        <mxCell id="m12" value="13. SELECT  →  UPDATE ProjectAssignments SET Role, EstimatedHours" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="838" /><mxPoint x="1070" y="838" /></Array></mxGeometry></mxCell>
        <mxCell id="m12r" value="200 OK — updated ProjectAssignmentDto" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;dashed=1;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="868" /><mxPoint x="240" y="868" /></Array></mxGeometry></mxCell>
        <mxCell id="nf1" value="alt [not found] → NotFoundException → 404 ProblemDetails" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1"><mxGeometry x="540" y="882" width="350" height="25" as="geometry" /></mxCell>

        
        <mxCell id="sec5" value="Remove Assignment" style="swimlane;startSize=18;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=2;fontSize=9;" vertex="1" parent="1"><mxGeometry x="60" y="925" width="1200" height="20" as="geometry" /></mxCell>
        <mxCell id="m13" value="14. Click Remove → confirm dialog" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="90" y="963" /><mxPoint x="240" y="963" /></Array></mxGeometry></mxCell>
        <mxCell id="m14" value="15. DELETE /api/admin/project-assignments/{projectId}/{userId}" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="993" /><mxPoint x="575" y="993" /></Array></mxGeometry></mxCell>
        <mxCell id="m15" value="16. SELECT  →  DELETE FROM ProjectAssignments WHERE ProjectId = ? AND UserId = ?" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="1023" /><mxPoint x="1070" y="1023" /></Array></mxGeometry></mxCell>
        <mxCell id="m15r" value="204 No Content" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;dashed=1;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="575" y="1053" /><mxPoint x="240" y="1053" /></Array></mxGeometry></mxCell>
        <mxCell id="m16" value="17. Remove row from assignments state" style="edgeStyle=orthogonalEdgeStyle;endArrow=open;endFill=1;fontSize=9;strokeWidth=2;" edge="1" parent="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="240" y="1083" /><mxPoint x="90" y="1083" /></Array></mxGeometry></mxCell>

        
        <mxCell id="footnote" value="All admin endpoints require X-Admin-Token header.&#10;In Development (RequireToken=false in appsettings.Development.json) the check is bypassed.&#10;In production Admin:RequireToken MUST be true.&#10;All endpoints are rate-limited to 60 req/min per IP (AdminRateLimit policy)." style="rounded=1;fillColor=#f5f5f5;strokeColor=#666;fontSize=9;align=left;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="60" y="1110" width="700" height="55" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>