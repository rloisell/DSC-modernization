---
work_package_id: "WP03"
title: "DepartmentsController — GET /api/departments/{id}/members + /api/org-chart"
lane: "planned"
subtasks:
  - "WP02"
phase: "Phase 3 — Controller"
assignee: ""
agent: ""
shell_pid: ""
review_status: ""
reviewed_by: ""
history:
  - timestamp: "2026-02-22T03:00:00Z"
    lane: "planned"
    agent: "system"
    action: "Prompt generated by GitHub Copilot spec-kitty session"
---

# Work Package Prompt: WP03 – DepartmentsController — GET /api/departments/{id}/members + /api/org-chart

## Files to Create

- `src/DSC.Api/Controllers/DepartmentsController.cs` (new)

## Steps

1. Controller with two actions:
   ```csharp
   // returns members of the specified department (role-gated via service)
   [HttpGet("{id:guid}/members")]
   public async Task<IActionResult> GetMembers(Guid id)

   // returns full org chart; Director/Admin only (enforced in service)
   [HttpGet("/api/org-chart")]
   public async Task<IActionResult> GetOrgChart()
   ```
2. Extract `callerId` from `X-User-Id` header.
3. Delegating to service; return `Ok(result)`.

## Acceptance

- [ ] Both routes accessible and return correct data
- [ ] `ForbiddenException` mapped to 403 by global handler

